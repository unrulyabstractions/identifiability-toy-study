wandb_project: spd-induction-heads
wandb_run_name: null

pretrained_model_path: wandb:induction-heads/runs/xaji0y6d # Example

seed: 0

batch_size: 16
steps: 1000000
lr: 1e-3
n_eval_steps: 200

task_config:
  task_name: induction_head

C: 100
n_mask_samples: 1
target_module_patterns: [
  "blocks.*.attn.q_proj",
  "blocks.*.attn.k_proj",
  "blocks.*.attn.v_proj",
  "blocks.*.attn.out_proj",
]

faithfulness_coeff: 100
recon_coeff: 1
stochastic_recon_coeff: 1
recon_layerwise_coeff: null
stochastic_recon_layerwise_coeff: 1
importance_minimality_coeff: 1e-2
pnorm: 0.1
output_loss_type: kl
gate_type: "vector_mlp"
gate_hidden_dims: [128]

n_examples_until_dead: 10000


# --- Logging & Saving ---
image_freq: 500
image_on_first_step: true
print_freq: 100
save_freq: null

pretrained_model_class: spd.experiments.ih.model.InductionTransformer
